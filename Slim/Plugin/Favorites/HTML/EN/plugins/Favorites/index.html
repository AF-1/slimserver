[% pagetitle = title | getstring; pageicon = 'PLUGINS' %]
[% PROCESS pageheader.html %]

[% IF errormsg %]<p>[% errormsg %]</p>[% END %]

[% IF load %]

	<form name="loadfile" method="get" action="[% webroot %]plugins/Favorites/index.html">
	[% "PLUGIN_FAVORITES_LOADFILE" | string %]
		<input type="hidden" name="index" value="[% levelindex %]">
		<input type="text" class="stdedit" name="filename" size="60">
		<input type="submit" class="stdclick" name="loadfile" value=[% "PLUGIN_FAVORITES_LOAD" | string %]>
		<input type="submit" class="stdclick" value=[% "PLUGIN_FAVORITES_CANCEL" | string %]>
	</form>

[% ELSIF save %]

	<form name="savefile" method="get" action="[% webroot %]plugins/Favorites/index.html">
	[% "PLUGIN_FAVORITES_SAVEFILE" | string %]
		<input type="hidden" name="index" value="[% levelindex %]">
		<input type="text" class="stdedit" name="filename" value="[% filename %]" size="60">
		<input type="submit" class="stdclick" name="savefile" value=[% "PLUGIN_FAVORITES_SAVE" | string %]>
		<input type="submit" class="stdclick" value=[% "PLUGIN_FAVORITES_CANCEL" | string %]>
	</form>

[% ELSIF import %]

	[% "PLUGIN_FAVORITES_IMPORT_DESC" | string %]
	<p></p>
	<form name="importfile" method="get" action="[% webroot %]plugins/Favorites/index.html">
	[% "PLUGIN_FAVORITES_IMPORTFILE" | string %]
		<input type="hidden" name="index" value="[% levelindex %]">
		<input type="text" class="stdedit" name="filename" size="60">
		<input type="submit" class="stdclick" name="importfile" value="[% "PLUGIN_FAVORITES_IMPORT" | string %]">
		<input type="submit" class="stdclick" value=[% "PLUGIN_FAVORITES_CANCEL" | string %]>
	</form>

[% ELSIF edittitle %]

	<form name="title" method="get" action="[% webroot %]plugins/Favorites/index.html">
		[% "TITLE" | string %]
		<input type="hidden" name="index" value="[% levelindex %]">
		<input type="text" class="stdedit" name="title" size="60" value="[% title %]">
		<input type="submit" class="stdclick" value=[% "SAVE" | string %]>
		<input type="submit" class="stdclick" value=[% "PLUGIN_FAVORITES_CANCEL" | string %]>
	</form>

[% ELSE %]

	[% IF NOT favorites %]<h4><a href="[% webroot %]plugins/Favorites/index.html?edittitle=1&index=[% index %]">[% title %]</a></h4>[% END %]
	
	[% odd = 1 %]
		
	[% WRAPPER contentcontainer %]
		[% FOREACH entry = entries %]
	
 			[% BLOCK favoritescontrol %]

				[% WRAPPER editlink noTarget=1 %]
					href="[% webroot %]plugins/Favorites/index.html?action=edit&index=[% entry.index %]"
				[% END %]
				[% WRAPPER moveuplink noTarget=1 %]
					href="[% webroot %]plugins/Favorites/index.html?action=moveup&index=[% entry.index %]"
				[% END %]
				[% WRAPPER movedownlink noTarget=1 %]
					href="[% webroot %]plugins/Favorites/index.html?action=movedown&index=[% entry.index %]"
				[% END %]
				[% WRAPPER removelink noTarget=1 %]
					href="[% webroot %]plugins/Favorites/index.html?action=delete&index=[% entry.index %]"
				[% END %]

				[% PROCESS dummylink %]

				[% IF entry.audio %]
					[% WRAPPER playlink noTarget=1 %]
						href="[% webroot %]plugins/Favorites/index.html?action=play&index=[% entry.index %]"
					[% END %]
					[% WRAPPER addlink noTarget=1 %]
						href="[% webroot %]plugins/Favorites/index.html?action=add&index=[% entry.index %]"
					[% END %]
				[% ELSE %]
					[% PROCESS dummylink %]
					[% WRAPPER descendlink noTarget=1 %]
						href="[% webroot %]plugins/Favorites/index.html?index=[% entry.index %]"
					[% END %]
				[% END %]

			[% END %]

			[% IF entry.edit %]
				[% WRAPPER contentitem lineclass = 'browsedbListItemFullWidth' %]
				[% IF entry.outline %]	
					<form name="edittitle" width="100%" method="get" action="[% webroot %]plugins/Favorites/index.html">
						<input type="hidden" name="index" value="[% entry.index %]">					
						<input type="hidden" name="action" value="editset">
						<input type="hidden" name="removeoncancel" value="[% removeoncancel %]">
						<input style="width: 80%;" type="text" class="stdedit" name="entrytitle" value="[% entry.title %]">
						<input type="submit" class="stdclick" name="editset" value=[% "SAVE" | string %]>
						<input type="submit" class="stdclick" name="cancel" value=[% "PLUGIN_FAVORITES_CANCEL" | string %]>
					</form>
				[% ELSE %]
					<form name="edittitleurl" width="100%" method="get" action="[% webroot %]plugins/Favorites/index.html">
						<input type="hidden" name="index" value="[% entry.index %]">
						<input type="hidden" name="action" value="editset">
						<input type="hidden" name="removeoncancel" value="[% removeoncancel %]">
						<input style="width: 39%;" type="text" class="stdedit" name="entrytitle" value="[% entry.title %]">
						<input style="width: 39%;" type="text" class="stdedit" name="entryurl" value="[% entry.url %]">
						<input type="submit" class="stdclick" name="editset" value=[% "SAVE" | string %]>
						<input type="submit" class="stdclick" name="cancel" value=[% "PLUGIN_FAVORITES_CANCEL" | string %]>
					</form>
				[% END %]
				[% END %]
			[% ELSE %]
				[% WRAPPER contentitem controls = 'favoritescontrol' %]
					<a href="[% webroot	%]plugins/Favorites/index.html?index=[% entry.index	%]">[% entry.title %]</a>
				[% END %]
			[% END %]
			
			[% odd = (not odd) %]
		[% END %]
	[% END %]

	[% IF deleted %]
		[% BLOCK favoritesdeleteditem %]
			[% WRAPPER removelink noTarget=1 %]
				href="[% webroot %]plugins/Favorites/index.html?forgetdelete&index=[% levelindex %]"
			[% END %]
			[% PROCESS dummylink %]	[% PROCESS dummylink %]	[% PROCESS dummylink %]
		[% END %]
		[% WRAPPER contentitem controls = 'favoritesdeleteditem'%]
			<a href="[% webroot	%]plugins/Favorites/index.html?insert&index=[% levelindex %]"><b><I>[% "PLUGIN_FAVORITES_INSERTDEL" | string %]</b> [ [% deleted %] ]</I></a>
		[% END %]
		[% odd = (not odd) %]
	[% END %]

	<p></p>
	<form name="buttons" method="get" action="[% webroot %]plugins/Favorites/index.html">
		<input type="hidden" name="index" value="[% levelindex %]">
		<input type="submit" class="stdclick" name="newentry" value="[% favorites ? "PLUGIN_FAVORITES_NEWFAVORITE" : "PLUGIN_FAVORITES_NEWENTRY" | string %]">
		<input type="submit" class="stdclick" name="newlevel" value="[% "PLUGIN_FAVORITES_NEWFOLDER" | string %]">
		<input type="submit" class="stdclick" name="import" value="[% "PLUGIN_FAVORITES_IMPORT" | string %]">
		[% IF NOT favorites %]
		<input type="submit" class="stdclick" name="load" value="[% "PLUGIN_FAVORITES_LOAD" | string %]">
		<input type="submit" class="stdclick" name="save" value="[% "PLUGIN_FAVORITES_SAVE" | string %]">
		[% END %]
	</form>

[% END %]

[% PROCESS pagefooter.html %]
