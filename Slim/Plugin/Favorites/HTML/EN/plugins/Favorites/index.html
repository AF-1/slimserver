[% BLOCK editentry %]
	[% WRAPPER contentitem leftcontrols = 'playcontrols' lineclass = 'browsedbListItemFullWidth' %]
		[% IF entry.outline %]
			<form name="edittitle" method="" style="display: inline; width: 100%;">
				<input type="hidden" name="index" value="[% entry.index %]">
				<input type="hidden" name="action" value="editset">
				<input type="hidden" name="removeoncancel" value="[% removeoncancel %]">
				<input id="edit_title_[% entry.index %]" style="width: 71%;" type="text" class="stdedit" name="entrytitle" value="[% entry.title %]" [% IF newlevel %] onClick="this.value=''"[% END %]>
				[% IF useAJAX %]
					<input type="button" style="display: inline; width: 10%;" value=[% "SAVE" | string %] onclick="editSave([% entry.index %]); return false;" />
					<input type="button" style="display: inline; width: 10%;" value=[% "PLUGIN_FAVORITES_CANCEL" | string %] onclick="editCancel([% entry.index %][% IF removeoncancel %],[% removeoncancel %][% END %]); return false;" />
				[% ELSE %]
					<input type="submit" style="display: inline; width: 10%;" class="stdclick" name="editset" value=[% "SAVE" | string %]>
					<input type="submit" style="display: inline; width: 10%;" class="stdclick" name="cancel" value=[% "PLUGIN_FAVORITES_CANCEL" | string %]>
				[% END %]
			</form>
		[% ELSE %]
			<form name="edittitleurl" method="" style="display: inline; width: 100%;">
				<input type="hidden" name="index" value="[% entry.index %]">
				<input type="hidden" name="action" value="editset">
				<input type="hidden" name="removeoncancel" value="[% removeoncancel %]">
				<input id="edit_title_[% entry.index %]" style="display: inline; width: 35%;" type="text" class="stdedit" name="entrytitle" value="[% entry.title %]" [% IF newentry %] onClick="this.value=''"[% END %]>
				<input id="edit_url_[% entry.index %]" style="display: inline; width: 35%;" type="text" class="stdedit" name="entryurl" value="[% entry.url %]" [% IF newentry %] onClick="this.value=''"[% END %]>
				[% IF useAJAX %]
					<input type="button" style="display: inline; width: 10%;" value=[% "SAVE" | string %] onclick="editSave([% entry.index %]); return false;" />
					<input type="button" style="display: inline; width: 10%;" value=[% "PLUGIN_FAVORITES_CANCEL" | string %] onclick="editCancel([% entry.index %][% IF removeoncancel %],[% removeoncancel %][% END %]); return false;" />
				[% ELSE %]
					<input type="submit" style="display: inline; width: 10%;" class="stdclick" name="editset" value=[% "SAVE" | string %]>
					<input type="submit" style="display: inline; width: 10%;" class="stdclick" name="cancel" value=[% "PLUGIN_FAVORITES_CANCEL" | string %]>
				[% END %]
			</form>
		[% END %]
	[% END %]
[% END %]

[% BLOCK favoritescontrol %]
	[% IF entry.favorites == 1 %]
		[% WRAPPER favaddlink noTarget=1 %]
			[%- IF useAJAX -%]href="javascript:void(0);" onClick="ajaxUpdate('index.html', 'action=favadd&index=[% entry.index %]')"
			[%- ELSE       -%]href="[% webroot %]plugins/Favorites/index.html?action=favadd&index=[% entry.index %]"
			[%- END -%]
		[% END %]
	[% ELSIF entry.favorites == 2 %]
		[% WRAPPER favdellink noTarget=1 %]
			[%- IF useAJAX -%]href="javascript:void(0);" onClick="ajaxUpdate('index.html', 'action=favdel&index=[% entry.index %]')"
			[%- ELSE       -%]href="[% webroot %]plugins/Favorites/index.html?action=favdel&index=[% entry.index %]"
			[%- END -%]
		[% END %]
	[% END %]
[% END %]

[% BLOCK editcontrols %]<span id="editcontrols[% entry.index %]" style="display: none;">
	[% IF entry.favorites == 1 %]
		[% WRAPPER favaddlink noTarget=1 %]
			[%- IF useAJAX -%]href="javascript:void(0);" onClick="ajaxUpdate('index.html', 'index.html', 'action=favadd&index=[% entry.index %]')"
			[%- ELSE       -%]href="[% webroot %]plugins/Favorites/index.html?action=favadd&index=[% entry.index %]"
			[%- END -%]
		[% END %]
	[% ELSIF entry.favorites == 2 %]
		[% WRAPPER favdellink noTarget=1 %]
			[%- IF useAJAX -%]href="javascript:void(0);" onClick="ajaxUpdate('index.html', 'action=favdel&index=[% entry.index %]')"
			[%- ELSE       -%]href="[% webroot %]plugins/Favorites/index.html?action=favdel&index=[% entry.index %]"
			[%- END -%]
		[% END %]
	[% END %]
	[% WRAPPER editlink noTarget=1 -%]
		[%- IF useAJAX -%]href="javascript:void(0);" onClick="edit([% entry.index %]);"
		[%- ELSE       -%]href="[% webroot %]plugins/Favorites/index.html?action=edit&amp;index=[% entry.index %]"
		[%- END -%]
	[%- END %]
	[%- IF NOT useAJAX %][% WRAPPER moveuplink noTarget=1 -%]
			href="[% webroot %]plugins/Favorites/index.html?action=moveup&amp;index=[% entry.index %]"
		[%- END %]
		[% WRAPPER movedownlink noTarget=1 -%]
			href="[% webroot %]plugins/Favorites/index.html?action=movedown&amp;index=[% entry.index %]"
	[%- END %][% END %]
	[% WRAPPER removelink noTarget=1 -%]
		[%- IF useAJAX -%]href="javascript:void(0);" onClick="ajaxUpdate('index.html', 'action=delete&amp;index=[% entry.index %]');"
		[%- ELSE       -%]href="[% webroot %]plugins/Favorites/index.html?action=delete&amp;index=[% entry.index %]"
		[%- END -%]
	[%- END %]</span>
[% END %]

[% BLOCK playcontrols %]
	[%- IF entry.audio -%]
		[% WRAPPER playlink noTarget=1 -%]
			[%- IF useAJAX -%]href="javascript:void(0);" onClick="ajaxRequest('index.html', 'action=play&amp;index=[% entry.index %]', refreshStatus);"
			[%- ELSE       -%]href="[% webroot %]plugins/Favorites/index.html?action=play&amp;index=[% entry.index %]" onClick="refreshStatus();"
			[%- END -%]
		[%- END %]
		[% WRAPPER addlink noTarget=1 -%]
			[%- IF useAJAX -%]href="javascript:void(0);" onClick="ajaxRequest('index.html', 'action=add&amp;index=[% entry.index %]', refreshStatus);"
			[%- ELSE       -%]href="[% webroot %]plugins/Favorites/index.html?action=add&amp;index=[% entry.index %]" onClick="refreshStatus();"
			[%- END -%]
		[%- END %]
	[%- ELSE -%]
		[% PROCESS dummylink %]
		[% PROCESS dummylink %]
	[%- END -%]
[% END %]

[% BLOCK entryblock -%]
	[%- WRAPPER contentitem leftcontrols = 'playcontrols' rightcontrols = 'editcontrols' %]
		<a id="dragitemhref_[% entry.index %]" href="[% webroot %]plugins/Favorites/index.html?&amp;index=[% entry.index %]">
		   <span id="dragitemtitle_[% entry.index %]">[% entry.title %]</span></a>
	[% END -%]
[% END %]
	
[% IF action == 'edit' AND useAJAX %]
	[% odd = 1 - (index % 2) %]
	[% PROCESS editentry entry = entries.$index %]
[% ELSIF action == "editset" AND useAJAX %]
	[% odd = 1 - (index % 2) %]
	[% PROCESS entryblock entry = entries.$index %]
[% ELSE %]
	
[% pagetitle = title | getstring; pageicon = 'PLUGINS' %]
	
[% IF useAJAX %][% pageHeaderScripts = BLOCK %]
	<script TYPE="text/javascript">[% PROCESS html/vars.js %]</script>
	<script type="text/javascript" src="[% webroot %]html/common.js?r=[% revision %]" ></script>
	<script type="text/javascript" src="[% webroot %]html/prototype.js?r=[% revision %]" ></script>
	<script type="text/javascript" src="[% webroot %]html/scriptaculous/scriptaculous.js?load=effects,dragdrop&amp;r=[% revision %]"></script>
	<script TYPE="text/javascript" src="[% webroot %]html/global.js?r=[% revision %]"></script>
	<script TYPE="text/javascript" src="[% webroot %]plugins/Favorites/html/favorites.js?r=[% revision %]"></script>
[% END %][% END %]
	
[% PROCESS pageheader.html %]

[%- IF errormsg %]<p>[% errormsg %]</p>[% END -%]

[%- IF NOT favorites %]<h4><a [% IF useAJAX -%]
		     href="javascript:void(0);" onClick="ajaxUpdate('index.html', 'action=edittitle&amp;index=[% entry.index %]');"
		   [%- ELSE %]
		     href="[% webroot %]plugins/Favorites/index.html?action=edittitle&amp;index=[% index %]"
		   [%- END %]>[% title %]</a></h4>
[% END -%]

[% odd = 1 %]
	
[% WRAPPER contentcontainer %]
	<ol id="draglist" style="padding: 0px; margin: 0px; border: 0px;">
	[% FOREACH entry = entries %]
		<li id="dragitem_[% entry.index %]" style="margin: 0px; padding: 0px; border: 0px;" 
			[% IF useAJAX %]onMouseDown="Event.observe('dragitem_[% entry.index %]', 'click', function(event) { checkSortable(event); });"
			onMouseOver="showControls('editcontrols[% entry.index %]');"
			onMouseOut="hideControls('editcontrols[% entry.index %]')"[% END %]>
		[% IF entry.edit -%]
			[%- PROCESS editentry -%]
		[%- ELSE -%]
			[%- PROCESS entryblock -%]
		[%- END %]
		</li>
		[%- odd = (not odd) -%]
	[%- END %]
	</ol>

[% IF deleted %]
	[% BLOCK favoritesdeleteditem %]
		[% WRAPPER removelink noTarget=1 %]
		[%- IF useAJAX -%]href="javascript:void(0);" onClick="ajaxUpdate('index.html', 'forgetdelete&amp;index=[% levelindex %]');"
		[%- ELSE       -%]href="[% webroot %]plugins/Favorites/index.html?forgetdelete&amp;index=[% levelindex %]"
		[%- END -%]
		[% END %]
		
	[% END %]
	[% WRAPPER contentitem controls = 'favoritesdeleteditem'%]
		<a [% IF useAJAX -%]
		     href="javascript:void(0);" onClick="ajaxUpdate('index.html', 'insert&index=[% levelindex %]');"
		   [%- ELSE %]
		     href="[% webroot %]plugins/Favorites/index.html?insert&amp;index=[% levelindex %]"
		   [%- END %]><b><I>[% "PLUGIN_FAVORITES_INSERTDEL" | string %]</b> [ [% deleted %] ]</I></a>
	[% END %]
	[% odd = (not odd) %]
[% END %]

[%# clear the last entry info %]
[% entry = '' %]
[% IF load %]<div id='loadfile' >
	[% WRAPPER contentitem leftcontrols = 'playcontrols' lineclass = 'browsedbListItemFullWidth' %]
	<form id='lodafile' name="loadfile" method="get" action="[% webroot %]plugins/Favorites/index.html" style="display: inline; width: 100%;">
		<input type="hidden" name="index" value="[% levelindex %]">
		<input type="text" class="stdedit" name="filename" style="width: 71%;" value="[% 'PLUGIN_FAVORITES_LOADFILE' | string %]" onClick="this.value=''">
		[% IF useAJAX %]
			<input type="button" style="display: inline; width: 10%;" value="[% 'PLUGIN_FAVORITES_LOAD' | string %]" onclick="editSave([% entry.index %]); return false;" />
			<input type="button" style="display: inline; width: 10%;" value="[% 'PLUGIN_FAVORITES_CANCEL' | string %]" onclick="Element.remove('loadfile'); showElements(['defaultform']);" />
		[% ELSE %]
			<input type="submit" class="stdclick" name="loadfile" value="[% 'PLUGIN_FAVORITES_LOAD' | string %]">
			<input type="submit" class="stdclick" value="[% 'PLUGIN_FAVORITES_CANCEL' | string %]">
		[% END %]
	</form>
	[% END %]</div>

[% ELSIF save %]<div id='savefile'>
	[% WRAPPER contentitem leftcontrols = 'playcontrols' lineclass = 'browsedbListItemFullWidth' %]
	<form  name="savefile" method="get" action="[% webroot %]plugins/Favorites/index.html" style="display: inline; width: 100%;">
		<input type="hidden" name="index" value="[% levelindex %]">
		<input type="text" class="stdedit" name="filename" style="width: 71%;" value="[% filename ? filename : 'PLUGIN_FAVORITES_SAVEFILE' | getstring %]" [% UNLESS filename %] onClick="this.value=''" [% END %]">
		[% IF useAJAX %]
			<input type="button" style="display: inline; width: 10%;" value="[% 'PLUGIN_FAVORITES_SAVE' | string %]" onclick="editSave([% entry.index %]); return false;" />
			<input type="button" style="display: inline; width: 10%;" value="[% 'PLUGIN_FAVORITES_CANCEL' | string %]" onclick="Element.remove('savefile'); showElements(['defaultform']);" />
		[% ELSE %]
			<input type="submit" class="stdclick" name="savefile" value="[% 'PLUGIN_FAVORITES_SAVE' | string %]">
			<input type="submit" class="stdclick" value="[% 'PLUGIN_FAVORITES_CANCEL' | string %]">
		[% END %]
	</form>
	[% END %]</div>

[% ELSIF import %]<div id='importfile'>
	[% WRAPPER contentitem leftcontrols = 'playcontrols' lineclass = 'browsedbListItemFullWidth' %]
	<form name="importfile" method="get" action="[% webroot %]plugins/Favorites/index.html" style="display: inline; width: 100%;">
		<input type="hidden" name="index" value="[% levelindex %]">
		<input type="text" class="stdedit" name="filename" style="width: 71%;" value="[% 'PLUGIN_FAVORITES_IMPORTFILE' | string %]" onClick="this.value=''">
		[% IF useAJAX %]
			<input type="button" style="display: inline; width: 10%;" value="[% 'PLUGIN_FAVORITES_IMPORT' | string %]" onclick="editSave([% entry.index %]); return false;" />
			<input type="button" style="display: inline; width: 10%;" value="[% 'PLUGIN_FAVORITES_CANCEL' | string %]" onclick="Element.remove('importfile'); showElements(['defaultform']);" />
		[% ELSE %]
			<input type="submit" class="stdclick" name="importfile" value="[% 'PLUGIN_FAVORITES_IMPORT' | string %]">
			<input type="submit" class="stdclick" value="[% 'PLUGIN_FAVORITES_CANCEL' | string %]">
		[% END %]
	</form>
	[% END %]</div>
[% END %]

[% END %]
[% WRAPPER contentcontainer %]
<div id="defaultform" [% IF editmode OR edittitle OR import %] style="display: none;"[% END %]>
	<form name="buttons" method="get" action="[% webroot %]plugins/Favorites/index.html">
		<input type="hidden" name="index" value="[% levelindex %]">
		[% IF useAJAX %]
			<input type="button" style="display: inline;" value="[% favorites ? 'PLUGIN_FAVORITES_NEWFAVORITE' : 'PLUGIN_FAVORITES_NEWENTRY' | string %]" onclick="ajaxUpdate('index.html', 'newentry&index=[% levelindex %]');">
			<input type="button" style="display: inline;" value="[% 'PLUGIN_FAVORITES_NEWFOLDER' | string %]" onclick="ajaxUpdate('index.html', 'newlevel&index=[% levelindex %]');">
			<input type="button" style="display: inline;" value="[% "PLUGIN_FAVORITES_IMPORT" | string %]" onclick="ajaxUpdate('index.html', 'import&index=[% levelindex %]');">
		[% ELSE %]
			<input type="submit" class="stdclick" name="newentry" value="[% favorites ? "PLUGIN_FAVORITES_NEWFAVORITE" : "PLUGIN_FAVORITES_NEWENTRY" | string %]">
			<input type="submit" class="stdclick" name="newlevel" value="[% 'PLUGIN_FAVORITES_NEWFOLDER' | string %]">
			<input type="submit" class="stdclick" name="import" value="[% 'PLUGIN_FAVORITES_IMPORT' | string %]">
		[% END %]
		[% IF NOT favorites %]
			[% IF useAJAX %]
				<input type="button" style="display: inline;" value="[% 'PLUGIN_FAVORITES_LOAD' | string %]" onclick="ajaxUpdate('index.html', 'load&index=[% levelindex %]');">
				<input type="button" style="display: inline;" value="[% 'PLUGIN_FAVORITES_SAVE' | string %]" onclick="ajaxUpdate('index.html', 'save&index=[% levelindex %]');">
			[% ELSE %]
				<input type="submit" class="stdclick" name="load" value="[% 'PLUGIN_FAVORITES_LOAD' | string %]">
				<input type="submit" class="stdclick" name="save" value="[% 'PLUGIN_FAVORITES_SAVE' | string %]">
			[% END %]
		[% END %]
	</form>
</div>
[% END %]
[% IF useAJAX %]<script TYPE="text/javascript">initListSortable('draglist'[% IF levelindex %], [% levelindex %][% END %]);</script>[% END %]

[% PROCESS pagefooter.html %]

[% END %]
