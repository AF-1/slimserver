[% extJsScripts = BLOCK %]
	<script type="text/javascript" src="[% webroot %]html/browse.js?r=[% revision %]"></script>
[% END %]

[% IF query %]
	[%# Add the search query to each link if available %]
	[% searchquery = 'query=' _ query _ '&amp;' %]
[% END %]

[% FILTER null %]
[% pageicon = 'RADIO'; noSpacer = NOT streaminfo; %]
[% pwd_list = [];
	FOREACH crumb IN crumb;
		crumbItem = BLOCK %]
			<a href="index.html?[% searchquery %]player=[% playerURI %]&amp;index=[% crumb.index %]&amp;homeCategory=[% homeCategory %]">[% crumb.name %]</a>
		[% END %]
		[% pwd_list.push(crumbItem) %]
	[% END %]
[% END # filter -%]

[% IF NOT ajaxUpdate %][% PROCESS pageheader.html dontscroll=1 %]<div id="mainbody">[% END %]

[% IF msg %][% WRAPPER contentcontainer %]
	<b>[% msg %]</b>
[% END %][% END %]

[% IF streaminfo %]
	<div class="xmlStreamInfo">
		[% IF streaminfo.item.enclosure || streaminfo.item.url %]
			<div id="songInfoHeader">
				[% WRAPPER playlink %]onclick="Utils.processRawCommand('index.html?[% searchquery %]action=play&amp;index=[% streaminfo.index %]&amp;player=[% player | uri %]');"[% END %] [% "PLAY_THIS_SONG" | string %]<br />
				[% WRAPPER addlink %]onclick="Utils.processRawCommand('index.html?[% searchquery %]action=add&amp;index=[% streaminfo.index %]&amp;player=[% player | uri %]');"[% END %] [% "ADD_THIS_SONG_TO_PLAYLIST" | string %]
			</div>
		[% END %]
	
		[% PROCESS xmlbrowser_streaminfo.html %]
	</div>
[% END %]

[% IF search %]
	<form id="searchForm" name="searchForm" method="GET">
		<input type="text" id="query" name="query" size="40" value="[% query %]"/>
		<input name="submit" type="submit" class="stdclick" value="[% "SEARCH" | string %]"><p>
		<input type="hidden" value="[% player %]" name="player">
	</form>
[% END %]

[%- IF items -%]
	<div id="browsedbHeader">
		[% IF hasPagebar %]
			<div class="pagerbox">
				<div class="pagerbox_top"><div></div></div>
				<div class="pagerbox_content">
					[% PROCESS pagebar %]
				</div>
				<div class="pagerbox_bottom"><div></div></div>
			</div>
		[% END %]
	</div>
	
	[% BLOCK favoritescontrol %]<span id="controls[% index _ (start + loop.index) %]" [% IF useAJAX %]style="display: none;"[% END %]>
		[% IF item.favorites == 1 %]
			[% WRAPPER favaddlink noTarget=1 %]
				href="index.html?action=favadd&index=[% index _ (start + loop.index) %]&amp;start=[% pageinfo.startitem %]&amp;player=[% player | uri %]&amp;homeCategory=[% homeCategory %]"
			[% END %]
		[% ELSIF item.favorites == 2 %]
			[% WRAPPER favdellink noTarget=1 %]
				href="index.html?action=favdel&index=[% index _ (start + loop.index) %]&amp;start=[% pageinfo.startitem %]&amp;player=[% player | uri %]&amp;homeCategory=[% homeCategory %]"
			[% END %]
		[% END %]</span>
	[% END %]
	
	[%- WRAPPER contentcontainer %]
		[% IF image %]
		<div>
			<img src="[% image %]" />
		</div>
		[% END %]
		
		[% IF itemsHaveAudio %]
			[%- BLOCK allcontrol -%]
				[% WRAPPER playlink %]onclick="Utils.processRawCommand('index.html?[% searchquery %]action=playall&amp;index=[% currentIndex %]&amp;player=[% player | uri %]');"[% END %]
				[% WRAPPER addlink %]onclick="Utils.processRawCommand('index.html?[% searchquery %]action=addall&amp;index=[% currentIndex %]&amp;player=[% player | uri %]');"[% END %]
			[%- END %]
			[%- WRAPPER contentitem leftcontrols = 'allcontrol' %]
				[% "ALL_SONGS" | string %]
			[%- END %]
		[% END %]
		
		[%- FOREACH item = items %]
			[%- BLOCK gencontrol -%]
				[% IF item.type == 'audio' || item.type == 'playlist' || item.enclosure || item.play %]
					[% WRAPPER playlink %]onclick="Utils.processRawCommand('index.html?[% searchquery %]action=play[% IF item.type == 'playlist' %]all[% END %]&amp;index=[% index _ (start + loop.index) %]&amp;player=[% player | uri %]');"[% END %]
					[% WRAPPER addlink %]onclick="Utils.processRawCommand('index.html?[% searchquery %]action=add[% IF item.type == 'playlist' %]all[% END %]&amp;index=[% index _ (start + loop.index) %]&amp;player=[% player | uri %]');"[% END %]
				[% ELSE %]
					[% PROCESS dummylink %]
					[% PROCESS dummylink %]
				[% END %]
			[%- END %]
			
			[% IF item.type == 'search' %]
				<form id="searchForm[% index _ (start + loop.index) %]" method="GET">
					[% item.name || item.title %]
					<input type="text" name="q" value=""/>
					<input name="submit" type="submit" class="stdclick" value="[% "SEARCH" | string %]"><p>
					<input type="hidden" value="[% player %]" name="player" />
					<input type="hidden" value="[% index _ (start + loop.index) %]" name="index" />
					<input type="hidden" value="[% homeCategory %]" name="homeCategory" />
				</form>
			[% ELSE %]
				[%- WRAPPER contentitem leftcontrols = 'gencontrol' rightcontrols = 'favoritescontrol' %]
					[% IF item.type != 'text' %]
					<a href="index.html?[% searchquery %]index=[% index _ (start + loop.index) %]&amp;player=[% player | uri %]&amp;homeCategory=[% homeCategory %]" class="browseItemLink">
					[% END %]
					[% item.name || item.title %]
					[% IF item.type != 'text' %]
					</a>
					[% END %]
				[%- END %]
			[%- END %]
		[%- END %]

	[%- END %]
[%- END %]

[%- IF hasPagebar; infoTab = BLOCK -%]
	<div>[% "ITEMS" | string %] [% pageinfo.startitem + 1 %] [% "TO" | string %] [% pageinfo.enditem + 1 %] [% "OF" | string %] [% pageinfo.totalitems %]</div>
[%- END; END -%]  

[% IF NOT ajaxUpdate %]</div>[% PROCESS pagefooter.html %][% END %]

