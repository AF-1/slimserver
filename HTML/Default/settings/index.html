[%- 	firstLevelItems = [
		'BASIC_SERVER_SETTINGS',
		'ITUNES',
		'PLUGIN_PODCAST',
		'SQUEEZENETWORK_SETTINGS',
		'INTERFACE_SETTINGS',
		'SETUP_GROUP_PLUGINS',
		'SERVER_STATUS',
		'PLUGINS',
		'BEHAVIOR_SETTINGS'
	];

BLOCK settingsPage -%]
	<div class="selectorMarker [% IF token == subPage %]selectedItem[% END %]" onclick="SettingsPage.onClicked(this);" onmouseover="SettingsPage.highlight(this);">
		<div class="selector_topRight"><div class="selector_topLeft"><div class="selector_bottomRight"><div class="selector_bottomLeft">
			<div class="homeMenuItem" id="[% token %][% IF category %]:[% category %][% END %]">
				<a href="[% href %]" target="subSettings" class="browseItemLink">[% title %]</a>
			</div>
		</div></div></div></div>
	</div>
[%- END -%]

[%- IF menu == 'advanced';
	PROCESS settings/header.html;

	links = additionalLinks.setup;

	IF links;
		FOREACH link = sortedLinks;
			IF !firstLevelItems.grep("^$link$").size;
				token = link;
				title = link | string | html;
				href = links.$link _ "player=" _ playerURI;
				IF playerid;
					href = href _ "&amp;playerid=" _ playerURI;
				END;
				PROCESS settingsPage;
			END;
		END;
	END;

	PROCESS settings/footer.html %]

[%- ELSIF menu == 'player';
	PROCESS settings/header.html;

	links = playersetup;
	USE Clients; players = Clients.get("id")
	%]
		<p>&nbsp;</p>
		<div id="playerSelector"></div>
		<p>&nbsp;</p>
		<script type="text/javascript">
			playerList = new Array(
			[% FOREACH playerobj IN players -%]
				{ id: "[% playerobj.id %]", name: "[% playerobj.name %]" }[% IF !loop.last; ','; END %]
			[% END %]
			);

			strings = new Array();
			[% PROCESS jsString id='CHOOSE_PLAYER' jsId='' %]

			if (Ext.isSafari)
				SettingsPage.initPlayerList();
			else
				Ext.EventManager.onDocumentReady(SettingsPage.initPlayerList);
		</script>
	[%

	IF links;
		FOREACH link = links;
			token = link.key;
			title = link.key | string | html;
			href = link.value _ "player=" _ playerURI;
			href = href _ "&amp;playerid=" _ playerURI;

			PROCESS settingsPage;
		END;
	END;

	PROCESS settings/footer.html %]

[%- ELSIF sub == 'player' && !playerid;
	PROCESS settings/header.html %]
	<p><br/>[% "NO_PLAYER_FOUND" | string %]</p>
	[% PROCESS settings/footer.html %]

[%- ELSIF sub -%]
	<frameset cols="250,*">
		[% IF !subPage && sub == 'player';
			subPage = "BASIC_PLAYER_SETTINGS";
		ELSIF !subPage;
			subPage = "FORMATTING_SETTINGS";
		END %]
		<frame src="[% webroot %]settings/index.html?player=[% playerURI %]&amp;menu=[% sub %]&amp;subPage=[% subPage %][% IF playerid %]&amp;playerid=[% playerURI; END %]" name="menu" frameborder="0">

		[% IF additionalLinks.setup.$subPage;
			myPage = additionalLinks.setup.$subPage;
		ELSIF playersetup.$subPage;
			myPage = playersetup.$subPage;
		ELSIF sub == 'player';
			myPage = webroot _ "settings/player/basic.html?player=" _ playerURI _ "&amp;playerid=" _ playerURI;
		ELSE;
			myPage = webroot _ "settings/server/formatting.html?player=" _ playerURI;
		END %]

		<frame src="[% myPage %]" name="subSettings" frameborder="0" marginwidth="15">
	</frameset>

[%- ELSE -%]
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
	<head>
		<title>[% "SERVER_SETTINGS" | string %]</title>

		<link rel="stylesheet" type="text/css" href="/html/ext/resources/css/ext-all.css" />
		<link rel="stylesheet" type="text/css" href="[% webroot %]slim-ext.css?r=[% revision %]" />
		<link rel="stylesheet" type="text/css" href="[% webroot %]slimserver.css?r=[% revision %]" />

		<style>
			html { background: #666666; }
		</style>

		<!--[if lte IE 6]>
		<link href="[% webroot %]ie.css?r=[% revision %]" type="text/css" rel="stylesheet">
		<![endif]-->
		<!--[if IE 7]>
		<link href="[% webroot %]ie7.css?r=[% revision %]" type="text/css" rel="stylesheet">
		<![endif]-->

		<script type="text/javascript" src="/html/ext/adapter/ext/ext-base.js?r=[% revision %]"></script>
		<script type="text/javascript" src="/html/ext/ext-all[% IF debug %]-debug[% END %].js?r=[% revision %]"></script>
		<script type="text/javascript">[% PROCESS html/vars.js %]</script>
		<script type="text/javascript" src="[% webroot %]html/settings.js?r=[% revision %]"></script>

		<script type="text/javascript">
			var strings = new Array();
			[% PROCESS jsString id='STATUS' jsId='' %]
			[% PROCESS jsString id='BASIC_SERVER_SETTINGS' jsId='basic' %]
			[% PROCESS jsString id='PLAYERS' jsId='' %]
			[% PROCESS jsString id='MY_MUSIC' jsId='mymusic' %]
			[% PROCESS jsString id='ITUNES' jsId='itunes' %]
			[% PROCESS jsString id='PLUGIN_PODCAST' jsId='podcasts' %]
			[% PROCESS jsString id='SQUEEZENETWORK_SETTINGS' jsId='squeezenetwork' %]
			[% PROCESS jsString id='INTERFACE_SETTINGS' jsId='interface' %]
			[% PROCESS jsString id='SETUP_GROUP_PLUGINS' jsId='plugins' %]
			[% PROCESS jsString id='ADVANCED_SETTINGS' jsId='advanced' %]
			[% PROCESS jsString id='SAVE_SETTINGS' jsId='save' %]
			[% PROCESS jsString id='SETTINGS' jsId='' %]
			[% PROCESS jsString id='SETTINGS_CHANGED_CONFIRM' jsId='' %]
			[% PROCESS jsString id='CLOSE' jsId='' %]
			[% PROCESS jsString id='YES' jsId='' %]
			[% PROCESS jsString id='NO' jsId='' %]
			[% PROCESS jsString id='CANCEL' jsId='' %]

			var iTunesEnabled  = '[% iTunesEnabled %]';
			var podcastEnabled = '[% podcastEnabled %]';

			Ext.EventManager.onDocumentReady(Settings.init, Settings, true);
		</script>
	</head>

	<body class="singlePanel settings">
		<img id="background" src="[% webroot %]html/images/background.png" alt="Background" />

		<div id="mainbody">

			<div id="header">
				<div id="header_left"></div>
				<div id="header_content">
					<span><a href="[% webroot %]"><img src="[% webroot %]html/images/spacer.gif" id="squeezeCenterLogo"></a></span>
					<span><a href="http://www.slimdevices.com" target="_blank"><img src="[% webroot %]html/images/spacer.gif" id="logitechLogo"></a></span>
				</div>
			</div>

			<div id="main">
				<div class="inner" id="mainpanel">
					<div class="inner_top"></div>
					<div class="inner_top_left">&nbsp;</div>
					<div class="inner_top_right">&nbsp;</div>
	
					<div id="inner_header">
						<div class="pagetitle">
							<div id="settingsTabs"></div>
						</div>
					</div>

					<iframe name="settings" width="100%" id="maincontent" frameborder="0" scrolling="auto"></iframe>

					<div id="infoTab" class="buttonbar">
						<table id="buttonbar">
							<tr>
								<td><span id="cancel"></span></td>
								<td><span id="save"></span></td>
							<tr>
						</table>
					</div>

					<div class="inner_bottom"></div>
					<div class="inner_bottom_left">&nbsp;</div>
					<div class="inner_bottom_right">&nbsp;</div>
				</div>

			</div>

			<div id="footer">
				<div id="footer_left"></div>
				<div id="footer_content">
				</div>
			</div>

		</div>
	</body>
</html>
[% END %]