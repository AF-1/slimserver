[% PROCESS settings/header.html %]

	<div class="prefHead">[% "SETUP_GROUP_PLUGINS" | string %]</div>
	<div class="prefDesc">[% "SETUP_GROUP_PLUGINS_DESC" | string %]</div>

	<p/>

	[% FOREACH plugin = sortedPlugins %]

		[% name     = plugins.$plugin.name %]
		[% desc     = plugins.$plugin.description %]
		[% version  = plugins.$plugin.version %]
		[% settings = plugins.$plugin.optionsURL %]
		[% enabled  = plugins.$plugin.state %]

		[% WRAPPER setting title=name %]

			[% IF settings AND enabled %]

			<input type="button" value="[% 'SETTINGS' | string %]" onClick="location.href='[% webroot %][% settings %][% IF player %]?player=[% playerURI %]&amp;playerid=[% playerURI %][% END %]'">

			[% ELSE %]

			<input type="button" value="[% 'SETTINGS' | string %]" disabled>

			[% END %]

			<!-- XXXX - need to check for pending uninstall / install -->
			[% IF enabled %]

			<input type="submit" id="[% name %].toggle" name="[% name %].disable" value="[% 'DISABLE' | string %]">

			[% ELSE %]

			<input type="submit" id="[% name %].toggle" name="[% name %].enable" value="[% 'ENABLE' | string %]">

			[% END %]

			<input type="submit" id="[% name %].uninstall" name="[% name %].uninstall" value="[% 'UNINSTALL' | string %]">

			[% IF NOT useTabList %]
			<script type="text/javascript">
				new Event.observe($('[% name %].toggle'), 'click', function(e) {
					$('settingsForm').setStyle({cursor:'wait'});
					Event.stop(e);
					new Ajax.Request($('settingsForm').action, {
						parameters: { useAJAX: 1, '[% name _ '.' _ (enabled ? 'disable' : 'enable') %]': 1, pageAntiCSRFToken: '[% pageAntiCSRFToken %]' },
						onSuccess: function() {
							if ($('[% name %].toggle').name == '[% name %].enable') {
								$('[% name %].toggle').name = '[% name %].disable';
								$('[% name %].toggle').value = '[% "DISABLE" | string %]';
							}
							else {
								$('[% name %].toggle').name = '[% name %].enable';
								$('[% name %].toggle').value = '[% "ENABLE" | string %]';
							}
							resizeSettingsSection();
							$('settingsForm').setStyle({cursor:'auto'});
						}
					});
				});

				new Event.observe($('[% name %].uninstall'), 'click', function(e) {
					$('settingsForm').setStyle({cursor:'wait'});
					Event.stop(e);
					new Ajax.Request($('settingsForm').action, {
						parameters: { useAJAX: 1, '[% name %].uninstall': 1, pageAntiCSRFToken: '[% pageAntiCSRFToken %]' },
						onSuccess: function(response) {
							var results = parseData(response.responseText);
							$('statusarea').update(results['warning']);
							resizeSettingsSection();
							$('settingsForm').setStyle({cursor:'auto'});
						}
					});
				});

			</script>
			[% END %]

		[% END %]

	[%- END -%]
		
[% PROCESS settings/footer.html %]
	