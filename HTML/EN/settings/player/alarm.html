[% IF useExtJS; extJsScripts = BLOCK %]   
	<script TYPE="text/javascript">
		Ext.onReady(function() {
			// I'm sorry IE6 laggers
			if (!Ext.isIE6) {
				Settings.Alarm.initTimeControls('[% timeFormat %]', '[% altFormats %]');
				Settings.Alarm.initSliders();
				Settings.Alarm.initDefaultVolumeBtns();
			}

			var el;
			if (el = Ext.get('alarm_remove_[% newAlarmID %]')) {
				el.on({
					click: {
						fn: function() {
							Ext.get('alarmtime[% newAlarmID %]').dom.value = '';
							Ext.get('alarm[% newAlarmID %]').setDisplayed('none');
							Ext.get('button[% newAlarmID %]').show();
						}
					}
				});
			}

			[% IF prefs.alarms.size %]   
			if (el = Ext.get('alarm[% newAlarmID %]'))
				el.setDisplayed('none');
			[% END %]
		});
	</script>
[% END; END %]
[% BLOCK alarmSetting %]
	[% WRAPPER settingSection %]

		[% alarmTitle = "ALARM_ALARM" | string %]
		[% WRAPPER settingGroup title=alarmTitle _ " " _ loop.count desc="" %]
			<select class="stdedit" name="alarm_enable[% alarm.id %]" id="alarm_enable[% alarm.id %]">
		
				[% FOREACH option = {
					'1' => 'ALARM_ON',
					'0' => 'ALARM_OFF',
				} %]
					<option [% IF alarm.enabled == option.key %]selected='selected' [% END %]value="[% option.key %]">[% option.value | string %]</option>
				[%- END -%]
				
			</select>
			<input type="hidden" name="alarm_id_[% alarm.id %]" value="1">
		[% END %]
	
		<div class="settingGroup">
			<div class="prefHead" style="font-weight:normal;">[% "ALARM_SET" | string %]</div>
			<div class="prefs" style="max-height:14px">
				<input type="text" class="stdedit timeControl" name="alarmtime[% alarm.id %]" id="alarmtime[% alarm.id %]" value="[% alarm.timeStr %]" size="15">
			&nbsp;</div>
		</div>
	
		[% alarmTitle = "ALARM_SET_DAYS" | string %]
		[% WRAPPER settingGroup title='<div style="font-weight:normal;">' _ alarmTitle _ "</div>" desc="" %]
			[% FOREACH day = [1 .. 7] %]
				[% day = day % 7 %]
				<input type="checkbox" name="alarmday[% alarm.id %][% day %]" id="alarmday[% alarm.id %][% day %]" value="1" [% alarm.day(day) ? "checked" : "" %]>
				<label for="alarmday[% alarm.id %][% day %]">[% "ALARM_DAY$day" | string %]</label>
			[% END %]
		[% END %]
	
		[% alarmTitle = "ALARM_SELECT_PLAYLIST" | string %]
		[% WRAPPER settingGroup title='<div style="font-weight:normal;">' _ alarmTitle _ "</div>" desc="" %]
			<select class="stdedit" name="alarmplaylist[% alarm.id %]" id="alarmplaylist[% alarm.id %]">
		
				[% FOREACH type IN playlistOptions  %]
					<optgroup label="[% type.key %]">
						[% FOREACH option IN type.value %]
							<option [% IF alarm.playlist == option.value %]selected [% END %]value="[% option.value %]">[% option.key %]</option>
						[%- END -%]
					</optgroup>
				[%- END -%]
				
			</select>
		[% END %]
	
		[% alarmTitle = "SETUP_ALARMVOLUME" | string %]
		[% WRAPPER settingGroup title='<div style="font-weight:normal;">' _ alarmTitle _ "</div>" desc="" %]
			<input type="checkbox" name="usesDefaultVolume[% alarm.id %]" class="usesDefaultVolume" id="usesDefaultVolume[% alarm.id %]" value="1"  [% alarm.usesDefaultVolume() ? "checked" : "" %]>
			<label for="usesDefaultVolume[% alarm.id %]" class="stdlabel">[% "ALARM_USE_DEFAULT_VOLUME" | string %]</label><br/>
			<input type="text" class="stdedit volumeSlider" name="alarmvolume[% alarm.id %]" id="alarmvolume[% alarm.id %]" value="[% alarm.volume || prefs.pref_alarmDefaultVolume %]" size="3">
		[% END %]
	
		[% alarmTitle = "ALARM_ALARM_REPEAT" | string %]
		[% WRAPPER settingGroup title='<div style="font-weight:normal;">' _ alarmTitle _ "</div>" desc="" %]
			<select class="stdedit" name="alarm_repeat[% alarm.id %]" id="alarm_repeat[% alarm.id %]">
		
				[% FOREACH option = {
					'1' => 'YES',
					'0' => 'NO',
				} %]
					<option [% IF alarm.repeat == option.key %]selected='selected' [% END %]value="[% option.key %]">[% option.value | string %]</option>
				[%- END -%]
			
			</select>
	
			[% IF alarm.id != newAlarmID || useExtJS %]
				<div>
					<br/><input name="alarm_remove_[% alarm.id %]" type="[% useExtJS && alarm.id == newAlarmID ? 'button' : 'submit' %]" class="stdclick" value="[% "ALARM_DELETE" | string %]" id="alarm_remove_[% alarm.id %]">
				</div>
			[% END %]
		[% END %]

	[% END %]

[% END %]

[% PROCESS settings/header.html %]

	[% WRAPPER setting title="ALARM_ALL_ALARMS" desc="ALARM_ALARMS_ENABLED_DESC" %]
		<select class="stdedit" name="pref_alarmsEnabled" id="pref_alarmsEnabled">
	
			[% FOREACH option = {
				'1' => 'ALARM_ON',
				'0' => 'ALARM_OFF',
			} %]
				<option [% IF prefs.pref_alarmsEnabled %]selected='selected' [% END %]value="[% option.key %]">[% option.value | string %]</option>
			[%- END -%]
			
		</select>
	[% END %]

	[% IF useExtJS && prefs.alarms.size %]
		[% WRAPPER setting title="ALARM" desc="ALARM_ADD_DESC" sectionID="button" _ newAlarmID %]
			<input name="AddAlarm" type="button" class="stdclick" value="[% "ALARM_ADD" | string %]" onclick="Ext.get('alarm[% newAlarmID %]').show();Ext.get('button[% newAlarmID %]').setDisplayed('none');">
		[% END %]
	[% END %]

	<div class="alarmSection">
	[% alarmTitle = "ALARM_NEW" | string; sectionID="alarm" _ newAlarmID %]
	[% PROCESS alarmSetting alarm = { 
		id      => newAlarmID
		day     => 1
		enabled => 1
		repeat  => 1
	} %]
	</div>

	<div class="alarmSection">
	[% FOREACH alarm = prefs.alarms %]
		[% PROCESS alarmSetting %]
	[% END %]
	</div>
	
	[% WRAPPER setting title="ALARM_DEFAULT_VOLUME" desc="" %]
		<input type="text" class="stdedit volumeSlider" name="pref_alarmDefaultVolume" id="alarmDefaultVolume" value="[% prefs.pref_alarmDefaultVolume %]" size="3">
	[% END %]

	[% WRAPPER setting title="SETUP_SNOOZE_SECONDS" desc="SETUP_SNOOZE_SECONDS_DESC" %]
		<input type="text" class="stdedit" name="pref_alarmSnoozeSeconds" id="alarmSnoozeSeconds" value="[% prefs.pref_alarmSnoozeSeconds %]" size="20">
	[% END %]

	[% WRAPPER setting title="ALARM_FADE" desc="" %]
		<select class="stdedit" name="pref_alarmfadeseconds" id="pref_alarmfadeseconds">
	
			[% FOREACH option = {
				'1' => 'YES',
				'0' => 'NO',
			} %]
				<option [% IF prefs.pref_alarmfadeseconds %]selected='selected' [% END %]value="[% option.key %]">[% option.value | string %]</option>
			[%- END -%]
			
		</select>
	[% END %]

	<div>&nbsp;</div>
[% PROCESS settings/footer.html %]
