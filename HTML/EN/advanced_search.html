[%- pagetitle = "ADVANCEDSEARCH" | string -%]
[%- pageHeaderMenu = BLOCK -%]
 / <a href="advanced_search.html?player=[% player | uri %]">[% "ADVANCEDSEARCH" | string %]</a>
[%- END -%]
[%- PROCESS pageheader.html -%]
[% IF searchlist_header or numresults > -1 %]
	<p>
		[% IF searchlist_header %]
			[% searchlist_header %]
		[% ELSIF numresults != '-1' %]
			[% "TRACKSMATCHING" | string %][% "COLON" | string %] [% numresults %]
		[% END %]
		&nbsp;
	</p>
	<hr>
[% END %]
	<div align="center">
		<table class="border" border="0" cellpadding="3" cellspacing="1" width="100%">
		<form action="advanced_search.html" method="GET" name="searchForm">
		<input type="hidden" value="[% player %]" name="player">
        	<tbody>

[% WRAPPER field title='TRACK' %]
		<input name="search.track_titlesearch" value="[% search.track_titlesearch.value %]" size="35" maxlength="100" type="text">
[% END %]

[% WRAPPER field title='ARTIST' %]
		<input name="search.contributor_namesearch" value="[% search.contributor_namesearch.value %]" size="35" maxlength="100" type="text">
[% END %]

[% WRAPPER field title='ALBUM' %]
		<input name="search.album_titlesearch" value="[% search.album_titlesearch.value %]" size="35" maxlength="100" type="text">
[% END %]

[% WRAPPER field title='GENRE' %]
		<select name="search.genre">
			<option value="">[% "ANY_GENRE" | string %]</option>
			[%- FOREACH genre = genres -%]
				[%- NEXT IF NOT genre.name OR genre.id == 1 %]
			<option value="[% genre.id %]" [% IF search.genre.value == genre.id %]selected[% END %]>[% genre.name %]</option>
			[%- END %]
		</select>
[% END %]

[% WRAPPER field title='LENGTH' %]
		[% logicalSelectionBlock(name='search.secs.op') %]

		<input name="search.secs" value="[% search.secs.value %]" size="4" maxlength="4" style="text-align: right;" type="text">
		[% "SECONDS" | string %]
[% END %]

[% WRAPPER field title='TRACK' %]
		[% logicalSelectionBlock(name='search.tracknum.op') %]

		<input name="search.tracknum" value="[% search.tracknum.value %]" size="3" maxlength="3" style="text-align: right;" type="text">
[% END %]

[% WRAPPER field title='YEAR' %]
		[% timeSelectionBlock(name='search.year.op') %]

		<input name="search.year" value="[% search.year.value %]" size="4" maxlength="4" style="text-align: right;" type="text">
[% END %]

[% WRAPPER field title='MODTIME' %]
		[% timeSelectionBlock(name='search.age.op') %]

		<input name="search.age" value="[% search.age.value %]" size="10" maxlength="10" type="text">
		&nbsp; ex: [% dateFormat %]
[% END %]

[% WRAPPER field title='BITRATE' %]
		[% logicalSelectionBlock(name='search.bitrate.op') %]

		<select name="search.bitrate">
			<option value="">[% "ANY_VALUE" | string %]</option>
		[%- FOREACH bitRate = [ 32 40 48 56 64 80 96 112 128 160 192 224 256 320 ] %]
			<option value="[% bitRate %]" [% IF search.bitrate.value == (bitRate * 100) %]selected[% END %]>[% bitRate %]</option>
		[%- END %]
		</select> [% "KBPS" | string %]
[% END %]

<!--
			<tr>
				<td class="content" align="right" valign="middle" width="30%">Sample Rate&nbsp;</td>
				<td class="content" align="left" valign="middle" width="70%">

					[% logicalSelectionBlock(name='search.samplerate.op') %]

					<select name="search.samplerate">
						<option value="">[% "ANY_VALUE" | string %]</option>

						[% FOREACH sampleRate = [ 32000 44100 ] %]
							<option value="[% sampleRate %]">[% sampleRate %]</option>
						[% END %]
					</select> kHz
<				/td>
			</tr>
-->

[% WRAPPER field title='TYPE' %]
		<select name="search.ct">
			<option value="">[% "ANY_TYPE" | string %]</option>
		[%- FOREACH type = fileTypes.keys %]
			<option value="[% type %]" [% IF search.ct.value == type %]selected[% END %]>[% fileTypes.$type %]</option>
		[%- END %]
		</select>
[% END %]

[% WRAPPER field title='FILELENGTH' %]
		[% logicalSelectionBlock(name='search.size.op') %]

		<input name="search.size" value="[% search.size.value %]" size="12" maxlength="12" style="text-align: right;" type="text">
		[% "BYTES" | string %]
[% END %]
<!-- 
	Not yet.

			<tr>
				<td class="content" align="right" nowrap="nowrap" valign="middle" width="30%">Lyrics</td>
				<td class="content" align="left" valign="middle" width="70%">
				  <input name="search.lyrics" value="" size="35" maxlength="1000" type="text">
				</td>
			</tr>
-->

			<tr>
				<td colspan="2" class="content" align="center" valign="middle">
					<br>
					<input value="[% "SEARCH" | string %]" type="submit">
					<input value="[% "CLEAR"  | string %]" type="reset">
				</td>
			</tr>
		
		</tbody></table>
	<div>

	<p>
	[% IF numresults != '-1' %]
		<hr>
		<p>
	[% END %]

	[% IF searchlist_pagebar %]
		<p>[% "PAGES" | string %][% "COLON" | string %][% searchlist_pagebar %]</p>
	[% END %]

	<table cellspacing="0" cellpadding="4">
		[% IF numresults != '-1' && numresults != '0' %]
		<tr>
			<td width="100%" class="even">[% "ALL_SONGS" | string %]</td>
			<td align="right" width="13" [% IF odd %]class="odd"[% END %] [% IF not odd %]class="even"[% END %]>
			      <nobr><a href="[% webroot %]status.html?player=[% player | uri %]&command=playlist&subcommand=playtracks&listref=searchResults" target="status">[% FILTER nbsp %][% "PLAY" | string %][% END %]</a></nobr>
			</td>
			
			<td align="right" width="13" [% IF odd %]class="odd"[% END %] [% IF not odd %]class="even"[% END %]>
			      <nobr><a href="[% webroot %]status.html?player=[% player | uri %]&command=playlist&subcommand=addtracks&listref=searchResults" target="status">[% FILTER nbsp %][% "ADD_TO_PLAYLIST" | string %][% END %]</a></nobr>
			</td>
		</tr>
	[% ELSIF numresults == '0' %]
		<td align="left">[% "EMPTY" | string%]</td>
	[% END %]
		[% browse_list %]
	</table>

	[% IF searchlist_pagebar %]
		<p>[% "PAGES" | string %][% "COLON" | string %][% searchlist_pagebar %]</p>
	[% END %]

	
  </body>
</html>
[%- FILTER null %]

[% MACRO logicalSelectionBlock BLOCK %]
	<select name="[% name %]">
		<option value="=" >[% "EQUALS" | string %]</option>
		<option value="&lt;" >[% "LESSTHAN" | string %]</option>
		<option value="&gt;" >[% "GREATERTHAN" | string %]</option>
		<option value="!=" >[% "NOT" | string %]</option>
	</select>
[% END %]

[% MACRO timeSelectionBlock BLOCK %]
	<select name="[% name %]">
		<option value="=" >[% "IS" | string %]</option>
		<option value="&lt;" >[% "BEFORE" | string %]</option>
		<option value="&gt;" >[% "AFTER" | string %]</option>
	</select>
[% END %]

[% BLOCK  field %]
			<tr>
				<td class="content" align="right" valign="middle" width="30%">[% title | string %]&nbsp;</td>
				<td class="content" align="left" valign="middle" width="70%">
				  [% content %]
				</td>
			</tr>
[% END %]
[% END -%]