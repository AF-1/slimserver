[% pageicon = 'help' %]
[% pagetitle = 'XML skin' %]
[% techinfo = '1' %]
[% PROCESS helpheader.html %]

<h4>Overview</h4>
<p>This document describes the XML skin, that allows the SlimServer to return 
XML instead of HTML. It is designed to enable the integration of the SlimServer with 
third party automation tools, such as AMX/Crestron touchpanels, or other 
&quot;home grown&quot; solutions.</p>
<p>The XML skin only changes what is returned by the Server, and not its 
interface. Please refer to <a href="http.html">The SlimServer Web Interface</a> 
documentation.</p>
<h4>Usage</h4>
<p>Because it is of no interest to human beings, this skin is hidden from the 
skin list available in the Server preferences. To enable the skin, use URLs with
this general form: </p>
<pre>http://server:port/xml/page.xml?parameter=value&...</pre>
<p>where <code>server</code>, <code>port</code>, <code>page</code>, and 
<code>parameter</code> must be replaced by appropriate values. For example, 
to browse the music library (in the following 
examples, the SlimServer is running on a computer with the IP address of 
10.0.1.201 using the default port 9000):
</p>
<pre>http://10.0.1.201:9000/xml/browse.xml</pre>
<p>The following values are possible for <code>page</code>:
</p>
<ul>
  <li><code>browse.xml</code>, to browse the music library following its directory structure</li>
  <li><code>browseid3.xml</code>, to browse the music library following its tag structure (genre, artist, album)</li>
  <li><code>search.xml</code>, to search for artists, album or songs</li>
  <li><code>songinfo.xml</code>, to get the full information on a song</li>
  <li><code>status.xml</code>, to get a player status and its current playlist, if any</li>
  <li><code>hitlist.xml</code>, to get the statistics maintained by the server</li>
</ul>
<p>For example (result edited for brevity):</p>
<pre><font color="#0000FF">
http://10.0.1.201:9000/xml/browse.xml
</font>
<font color="#FF0000">
&lt;?xml version="1.0" standalone="no"?&gt;
&lt;!DOCTYPE browse SYSTEM "html/slimserver_xml.dtd"&gt;
&lt;browse xmlns="http://www.slimdevices.com/slimserver/xml"&gt;
  &lt;offsets&gt;
    &lt;from&gt;0&lt;/from&gt;
    &lt;to&gt;7&lt;/to&gt;
    &lt;last&gt;194&lt;/last&gt;
  &lt;/offsets&gt;
  &lt;browse_entry&gt;
    &lt;dir&gt;
      &lt;dir_name&gt;A-Ha&lt;/dir_name&gt;
      &lt;dir_browse_url&gt;&lt;![CDATA[xml/browse.xml?dir=A-Ha]]&gt;&lt;/dir_browse_url&gt;
    &lt;/dir&gt;
    &lt;replace_url&gt;
      &lt;![CDATA[xml/status.xml?p0=playlist&amp;p1=load&amp;p2=%2fVolumes%2fiMusic%2fiTunes%2fiTunes%20Music%2fA-Ha]]&gt;
    &lt;/replace_url&gt;
    &lt;append_url&gt;
      &lt;![CDATA[xml/status.xml?p0=playlist&amp;p1=add&amp;p2=%2fVolumes%2fiMusic%2fiTunes%2fiTunes%20Music%2fA-Ha]]&gt;
    &lt;/append_url&gt;
  &lt;/browse_entry&gt;
  ...
&lt;/browse&gt;</font></pre>
<h4>General parameters</h4>
<p>The following parameters are applicable to all pages that return many items
(potentially all pages except <code>songinfo.xml</code>):
</p>
<ul>
  <li><code>itemsPerPage=number</code>, to indicate how many items to return. This way, 
  the Server can be set up with a &quot;human acceptable&quot; value for this 
  setting (say, 100), while a limited automation device can request pages 
  containing only, say, 10 items.</li>
  <li><code>start=number</code>, to indicate which is the first item in the page, 
  useful in conjunction with <code>itemsPerPage</code>. This value is an offset, 
  i.e. the first item is 0, and the last <code>itemsPerPage-1</code>. Each page 
  returns its position in the entire list; see the <code>offsets</code> tag in the 
  example above.</li>
</ul>  
<p>The example above could have been requested as <code>http://10.0.1.201:9000/xml/
browse.xml?itemsPerPage=8&start=0</code>.</p>
<p>The following parameter must be added to the page <code>status.xml</code>:</p>
<ul>
  <li><code>player=player_id</code>, to indicate which player we're talking about. If
  absent, the Server will randomly choose a player.</li>
</ul>
<h5>The <code>include.html</code> file</h5>
<p>The following parameters are set in the XML skin <code>include.html</code> file:</p>
<ul>
  <li><code>[SET nopagebar 0]</code>, to prevent the generation of pagebars. 
  <b>Do not</b> set this to 1 or &quot;ugly&quot; HTML will appear in the XML.</li>
  <li><code>[SET includeItemStats 0]</code>, to prevent the statistics calculations.</li>
</ul>  
<p>If desired, <code>[SET itemsPerPage number]</code> could be added instead of adding
it to every URL. If a single player is automated, <code>[SET player player_id]</code> 
could be another option.</p>
<p>Be aware that this file is within the Server software release. Any changes will be 
overwritten by any upgrade to the Server software.</p>
<h4>Pages parameters</h4>
<p>An efficient client can be implemented without knowing much about parameters, 
as the XML includes special tags (ending in <code>_url</code>) containing &quot;links&quot;. 
In our example above, in order to browse the directory &quot;A-Ha&quot;, one simply 
requests the URL indicated by the <code>dir_browse_url</code>. Similar tags exists 
for most operations. The <code>player</code> parameter <b>must</b> be added to any 
URL targetting a player, such as <code>replace_url</code> above.</p>
<h5><code>search.xml</code> parameters</h5>
<p>The following parameters must be provided:</p>
<ul>
  <li><code>type=artist</code> or <code>type=album</code> or <code>type=song</code>, 
  to search artists, albums or songs, respectively.</li>
  <li><code>query=A_WORD+ANOTHER_WORD+...</code>, to indicate the string searched. Words
  must be correctly escaped as URL rules dictate and separated by <code>+</code>.</li>
</ul>
<h5><code>hitlist.xml</code> parameters</h5>
<p><code>hitlist.xml</code> takes no parameters.</p>
<h5>Other pages parameters</h5>
<p>Please refer to <a href="http.html">The SlimServer Web Interface</a> 
documentation for parameters to the <code>status.xml</code> page. Discovering the 
parameters of the other pages is left as an exercise to the reader.</p>
<p>PS: Seriously, the only way for a client to discover the value of parameters 
to <code>browse.xml</code>, <code>browseid3.xml</code> and <code>songinfo.xml</code> 
is to use the XML interface to browse the library in the first place. Therefore, 
the links will have been calculated for you already in the <code>_url</code> tags!.<p>
<h4>The DTD</h4>
<p>The XML skin comes with a heavily commented DTD, indicated in <code>DOCTYPE</code> 
and that can be served by the SlimServer. Please refer to it for more information 
on the various tags returned.</p>
<h4>Limitations</h4>
<p>The skin does not support:</p>
<ol>
  <li> Moodlogic URLs (because I have no way to test and I am unsure how 
  &quot;automated&quot; the Moodlogic software is)</li>
  <li> Configuring the server and player</li>
  <li> Item statistics (i.e. this genre includes &quot;12 albums with 
  130 songs by 10 artists&quot;) (<code>[SET includeItemStats 0]</code> in include.html)</li>
</ol>
[% PROCESS helpfooter.html %]