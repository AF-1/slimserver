[% pagetitle = 'PLUGIN_RANDOM' | string %]
[% IF type;
	SET refresh = 0.1;
	SET refreshurl = "${webroot}status.html?";
   END %]

[% BLOCK playLinks %]
	<tr bgcolor="[% bgC %]">
		<td width="100%">[% title | string %]</td>
		<td width="13">
			<a href="[% webroot %]plugins/RandomPlay/randomplay_mix.html?player=[% player | uri %]&type=[% type %]">
				<img src="[% webroot %]html/images/b_play.gif" width=13 height=13 alt="[% "PLAY" | string %]" title="[% "PLAY" | string %]">
			</a>
		</td>
		<td width="13">
			<a href="[% webroot %]plugins/RandomPlay/randomplay_mix.html?player=[% player | uri %]&type=[% type %]&addOnly=1">
				<img src="[% webroot %]html/images/b_add.gif" width=13 height=13 alt="[% "ADD" | string %]" title="[% "ADD" | string %]">
			</a>
		</td>
	</tr>
[% END %]

[% PROCESS pageheader.html %]
[% WRAPPER submenu url="${webroot}plugins/RandomPlay/randomplay_list.html" linktitle=pagetitle %][% END %]

	<p></p>

	[% IF warn %]
		<b>[% "NOTE" | string %]</b> [% "SCAN_WARNING" | string %]
		[% IF audiodir %]
			[% "SCAN_CLICK" | string %] <a href="[% webroot %]browse.html?player=[% player | uri %]">[% "HERE" | string %]</a>.
		[% END %]
	[% END %]
	<form action="[% webroot %]plugins/RandomPlay/randomplay_settings.html">
	[% IF player == '' %]
		<p>[% "NO_PLAYER_FOUND" | string %]</p>
	[% END %]
	[% IF player != '' %]
		<p><b>[% "PLUGIN_RANDOM_CHOOSE_DESC" | string %]</b></p>

		<table border="0" cellspacing="0" cellpadding="4" width="100%">
			[% PROCESS playLinks bgC=evenC title='PLUGIN_RANDOM_TRACK_DESC' type='track' %]
			[% PROCESS playLinks bgC=oddC title='PLUGIN_RANDOM_ARTIST_DESC' type='artist' %]
			[% PROCESS playLinks bgC=evenC title='PLUGIN_RANDOM_ALBUM_DESC' type='album' %]
			[% PROCESS playLinks bgC=oddC title='PLUGIN_RANDOM_YEAR_DESC' type='year' %]

	[% END %]
				<tr>
					<td></td>
				</tr>

				<tr>
					<td class="even">
						<hr><h3>[% "SETUP_MIX_SETTINGS" | string %]:</h3></td>
				</tr>

				<tr>
					<td class="even"></td>
				</tr>

				<tr>
					<td class="even"><h3>[% "PLUGIN_RANDOM_GENRE_FILTER" | string %]</h3></td>
				</tr>

				<tr>
					<td class="even">[% "SETUP_SELECT_GENRES_DESC" | string %]</td>
				</tr>

				<tr>
					<td class="even">
						<table border="0">
							[% PERL %]
								require POSIX;

								my $genreList = $stash->{'pluginRandomGenreList'};
								my @keys = sort(keys(%$genreList));
								my $inc = POSIX::ceil(@keys / 2);
								my ($genre, $checkedString);
								for (my $i = 0; $i < $inc; $i++) {
									$genre = $keys[$i];
									$checkedString = $genreList->{$genre} ? 'checked' : '';
									print "<tr><td><label for='${genre}CheckBox'>$genre</label></td>\n";
									print "<td><input type='checkbox' name='genre_$genre' id='${genre}CheckBox' value='1' $checkedString></td>\n";
									if ($i + $inc < @keys) {
										$genre = $keys[$i + $inc];
										$checkedString = $genreList->{$genre} ? 'checked' : '';
										print '<td>' . '&nbsp;' x 10 . "</td>\n";
										print "<td><label for='${genre}CheckBox'>$genre</label></td>\n";
										print "<td><input type='checkbox' name='genre_$genre' id='${genre}CheckBox' value='1' $checkedString></td>\n";
									}
									print '</tr>';
								}
							[% END %]
						</table>
					</td>
				</tr>
				<tr>
					<td class="even"><input type="submit" value="[% "CHANGE" | string %]"></td>
				</tr>

				<tr>
					<td class="even">
						<label>
							<b>[% "SETUP_PLUGIN_RANDOM_NUMBER_OF_TRACKS" | string %]:</b>
							<input class="stdedit" type="text" size="3" name="numTracks" value="[% pluginRandomNumTracks %]">
						</label>
					</td>
				</tr>

				<tr>
					<td class="even">[% "SETUP_PLUGIN_RANDOM_NUMBER_OF_TRACKS_DESC" | string %]</td>

				<tr>
					<td class="even"></td>
				</tr>

				<tr>
					<td class="even">
						<label>
							<b>[% "SETUP_PLUGIN_RANDOM_NUMBER_OF_OLD_TRACKS" | string %]:</b>
							<input class="stdedit" type="text" size="3" name="numOldTracks" value="[% pluginRandomNumOldTracks %]">
						</label>
					</td>
				</tr>

				<tr>
					<td class="even">[% "SETUP_PLUGIN_RANDOM_NUMBER_OF_OLD_TRACKS_DESC" | string %]</td>
				</tr>

				<tr>
					<td class="even"><input type="submit" value="[% "CHANGE" | string %]"></td>
				</tr>
			</table>
		</form>
[% PROCESS pagefooter.html %]


